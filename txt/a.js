(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9603],{35243:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/search",function(){return r(71089)}])},71089:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return search}});var s=r(85893),n=r(11163),a=r(67294),o=r(18127),c=r(70390),i=r(35245),l=r(35786),u=r(63366),d=r(27246),h=r(46597),_=r(94184),g=r.n(_),m=r(35386),x=r(64242),p=r(47036),C=r(8775),j=r(12752),f=r(65625),S=r(86510),b=r(89881),v=r.n(b);function SearchSuggestionsSlider(e){let{className:t,searchValue:r,suggestions:n,onSuggestionClick:o}=e,c=(0,a.useRef)(null),i=(0,j.v)();(0,a.useEffect)(()=>{c.current&&c.current.slideTo(0)},[n]);let l=(0,a.useCallback)(e=>{let t=n.map(e=>e.tap);i({name:"search_suggest",payload:{button:{text:e.tap},search:{query:r},tag:{results:t,position:t.indexOf(e.tap)+1,count:n.length}}}),o?.(e)},[o,r,i,n]);return(0,s.jsx)("div",{className:g()(v().root,t),children:(0,s.jsx)(f.i,{withAutoSlidesPerView:!0,onSwiper:e=>c.current=e,children:n.map(e=>(0,s.jsx)(f.M,{className:v().slide,children:(0,s.jsx)(S.Q,{suggestion:e,onClick:l})},e.tap))})})}var y=r(8640),k=r(41167),N=r(92706),L=r(55659),M=r(52612),T=r(64347),w=r.n(T);function CatalogTreeCard(e){let{category:t,isActive:r,onClick:n}=e;return(0,s.jsxs)(M.I,{onClick:n,category:t,className:g()(w().card,{[w().active]:r}),children:[(0,s.jsx)("div",{className:w().image,style:{backgroundImage:`url(${t.image})`}}),(0,s.jsx)(y.xv,{type:"h5Bold",className:w().text,color:y.O9.dark,children:t.name})]})}var I=r(86471),R=r.n(I);function CatalogTreeList(){let e=(0,L.CG)(k.xm);return(0,s.jsx)(s.Fragment,{children:e.map((e,t)=>(0,s.jsxs)("div",{className:R().categoryTreeBlock,children:[0!==t&&(0,s.jsx)("div",{className:R().categoryTreeBlockName,children:(0,s.jsx)(y.xv,{type:"p2SemiBold",color:y.O9.grey2,children:e.name})}),(0,s.jsx)("div",{className:R().categoryTreeList,children:e.children.map(e=>(0,s.jsx)(N.R,{name:"category_click",payload:{button:{text:e.name}},children:t=>{let{createSendEventCallback:r}=t;return(0,s.jsx)(CatalogTreeCard,{onClick:r(),category:e})}},e.id))})]},e.id))})}var G=r(31567),P=r(75491),W=r(9365),z=r.n(W);function CategoriesListSearch(e){let{className:t,searchValue:r,categories:n}=e,{t:o}=(0,G.$)("categories"),c=(0,j.v)(),[i,l]=(0,a.useState)(!1),u=n.length-3;(0,a.useEffect)(()=>{l(!1)},[n]);let d=(0,a.useMemo)(()=>i?n:n.slice(0,3),[n,i]),h=(0,a.useCallback)(()=>l(!0),[]),_=(0,a.useCallback)(e=>{c({name:"search_suggest_category",payload:{button:{text:e.name},search:{query:r},category:{results:n.map(e=>e.name),position:n.map(e=>e.id).indexOf(e.id)+1,count:n.length}}})},[n,r,c]);return(0,s.jsxs)("div",{className:g()(z().root,t),children:[d.map(e=>(0,s.jsx)(P.f,{category:e,onClick:_},e.id)),!i&&u>0&&(0,s.jsxs)(y.zx,{className:z().button,onClick:h,size:"s",theme:"secondary",children:["Еще ",u," ",(0,s.jsx)(s.Fragment,{children:o("category",{count:u})})]})]})}var E=r(53925),A=r(76966),B=r(95115),D=r(6403),F=r(86957),O=r(31357),q=r.n(O);function MobileSearchContent(e){let{searchInputRef:t}=e,r=(0,n.useRouter)(),o=(0,L.TL)(),c=(0,a.useRef)(null),i=(0,L.CG)(d.Ay),l=(0,L.CG)(d.Sy),h=(0,L.CG)(d.gd),_=(0,L.CG)(d.g4),j=(0,L.CG)(d.I5),f=(0,L.CG)(d.dQ),S=(0,E.y)("categoriesSearch"),b=(0,L.CG)(e=>(0,d.gp)(e,_)),v=(0,E.y)("optimizedSearch"),y=(0,L.CG)(d.M4),k=S&&h.length>0,N=v&&f.length>0;(0,m.Z)(()=>{let e=r.pathname;r.replace({pathname:e,query:{value:_}},void 0,{shallow:!0}),o((0,u.s3)(_)),window.scroll(0,0)},200,[_]);let M=(0,a.useCallback)(()=>{let e=c.current;e&&e.scroll({top:0,behavior:"smooth"})},[c]),T=(0,a.useCallback)(e=>{let t=e.target.value;o((0,u.gI)(t)),t.length>2?o((0,u.k8)(!0)):o((0,u.k8)(!1)),0===t.length&&(o((0,u.wR)([])),o((0,u.I2)([])),o((0,u.AD)(!1)))},[o]),w=(0,a.useCallback)(()=>{o((0,u.gI)("")),o((0,u.wR)([])),o((0,u.I2)([])),o((0,u.AD)(!1)),M(),t?.current?.focus()},[o,M,t]),I=(0,a.useCallback)(()=>{r.push(j).then(()=>o((0,u.W5)()))},[o,j,r]),R=(0,a.useMemo)(()=>l&&0===i.length?(0,s.jsxs)("div",{className:g()(q().productList,q().skeletonContainer),children:[(0,s.jsx)(A.m,{},"product_1"),(0,s.jsx)(A.m,{},"product_2"),(0,s.jsx)(A.m,{},"product_3"),(0,s.jsx)(A.m,{},"product_4"),(0,s.jsx)(A.m,{},"product_5"),(0,s.jsx)(A.m,{},"product_6")]}):y?(0,s.jsx)(p.P,{}):(l||b||_.length<3)&&!i.length&&!y?(0,s.jsx)(B.C,{name:"search_categories",children:(0,s.jsx)(CatalogTreeList,{})}):(0,s.jsxs)(s.Fragment,{children:[k&&(0,s.jsx)(CategoriesListSearch,{className:q().categories,categories:h}),(0,s.jsx)(x.R,{className:q().productsList,products:i})]}),[l,b,_.length,y,k,h,i]);return(0,a.useEffect)(()=>{M()},[M,i]),(0,s.jsx)(D.n,{name:"Search",children:(0,s.jsxs)("div",{className:q().root,children:[(0,s.jsxs)("div",{className:q().searchHeader,children:[(0,s.jsxs)("div",{className:q().searchInputContainer,children:[(0,s.jsx)(F.W,{type:"back",onClick:I}),(0,s.jsx)(C.M,{forwardedRef:t,value:_,onClear:w,onChange:T,isLoading:l,onFocus:M})]}),N&&(0,s.jsx)(SearchSuggestionsSlider,{suggestions:f})]}),(0,s.jsx)("div",{ref:c,className:g()(q().contentContainer,{[q().contentContainerWithSuggestions]:!!f.length}),children:R})]})})}var H=r(3854),Q=r.n(H);function SearchResultsSkeleton(){return(0,s.jsxs)("div",{className:Q().productList,children:[(0,s.jsx)(A.m,{},"product_1"),(0,s.jsx)(A.m,{},"product_2"),(0,s.jsx)(A.m,{},"product_3"),(0,s.jsx)(A.m,{},"product_4"),(0,s.jsx)(A.m,{},"product_5"),(0,s.jsx)(A.m,{},"product_6")]})}var V=r(1079),J=r(50328),X=r(37204),Y=r(68992),Z=r(73026),K=r(60807),U=r.n(K),search=function(){let e=!(0,Z.dD)(),t=(0,n.useRouter)(),r=(0,L.TL)(),{value:_}=t.query,g=(0,a.useRef)(null),m=(0,L.CG)(e=>(0,d.gp)(e,_||""));return(0,a.useEffect)(()=>{window.scroll(0,0)},[]),(0,a.useEffect)(()=>{g.current&&g.current?.focus()},[]),(0,o.Z)(()=>{_&&((_.length>=3||m)&&r((0,u.k8)(!0)),r((0,u.gI)(_)))}),(0,o.Z)(()=>(document?.body?.classList.add(U().body),()=>document?.body?.classList.remove(U().body))),(0,s.jsxs)(i.A,{hideNavbar:!0,gutterSize:J.J.None,contentWrapper:e?h.v:void 0,searchInputRef:g,className:U().searchMobileScreen,children:[(0,s.jsx)(Y.V,{title:"Быстрая доставка продуктов на дом — Заказать продукты на дом с бесплатной доставкой",description:"Самокат — онлайн-магазин с доставкой продуктов и товаров для дома от 15 минут. Заказывайте бесплатную экспресс-доставку продуктов, готовой еды и других товаров ◾ Выгодные цены ◾ Свежие продукты ◾ Акции и скидки ◾"}),(0,s.jsx)(X.P,{children:(0,s.jsx)(SearchResultsSkeleton,{})}),(0,s.jsx)(V.i,{children:(0,s.jsxs)("div",{className:U().root,children:[(0,s.jsx)(MobileSearchContent,{searchInputRef:g}),(0,s.jsx)(c.l,{}),(0,s.jsx)(l.D,{className:U().body})]})})]})}},68992:function(e,t,r){"use strict";r.d(t,{V:function(){return PageMeta}});var s=r(85893);r(67294);var n=r(14267),a=r(55659),o=r(17490);function PageMeta(e){let t=(0,a.CG)(n.om);return t?null:(0,s.jsx)(o.h,{...e})}},64347:function(e){e.exports={card:"CatalogTreeCard_card__dcIb_",active:"CatalogTreeCard_active__namwK",image:"CatalogTreeCard_image__wJFNW",text:"CatalogTreeCard_text__9gsAz"}},86471:function(e){e.exports={categoryTreeBlockName:"CatalogTreeList_categoryTreeBlockName__SXeuY"}},9365:function(e){e.exports={root:"CategoriesListSearch_root__W1C8i",button:"CategoriesListSearch_button__D1s_m"}},31357:function(e){e.exports={productList:"ProductsList_productList__jjQpU",root:"MobileSearchContent_root__epfrB",searchHeader:"MobileSearchContent_searchHeader__gqAWa",searchInputContainer:"MobileSearchContent_searchInputContainer__WThL9",contentContainer:"MobileSearchContent_contentContainer__3apIF",contentContainerWithSuggestions:"MobileSearchContent_contentContainerWithSuggestions__hjIpz",skeletonContainer:"MobileSearchContent_skeletonContainer__8tzHQ",productsList:"MobileSearchContent_productsList__Y_iJr",categories:"MobileSearchContent_categories__7WxCo"}},3854:function(e){e.exports={productList:"ProductsList_productList__jjQpU"}},89881:function(e){e.exports={slide:"SearchSuggestionsSlider_slide__MV5Yl"}},60807:function(e){e.exports={content:"MobileScreen_content___PHLC",size_none:"MobileScreen_size_none__wvDGT",body:"CatalogPage_body__bmKL9",searchMobileScreen:"SearchPage_searchMobileScreen___pzlf"}}},function(e){e.O(0,[4736,8970,9774,1414,1575,2888,179],function(){return e(e.s=35243)}),_N_E=e.O()}]);